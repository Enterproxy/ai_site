(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[648],{1886:(e,t,a)=>{"use strict";a.d(t,{Nn:()=>l,P_:()=>s,XX:()=>d,_R:()=>i,gJ:()=>r,oP:()=>n,sW:()=>o});async function n(e,t){let a=await fetch("/api/documents/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw console.error("❌ Błąd zapisu edytowanego dokumentu:",await a.text()),Error("Nie udało się zapisać zmian");return a.json()}async function s(e,t){let a=await fetch("/api/documents"),n=await a.text();if(!a.ok){let e=n;try{let t=JSON.parse(n);e=t.error||JSON.stringify(t)}catch(e){}return console.error("Błąd pobierania dokument\xf3w:",a.status,e),[]}return JSON.parse(n).filter(a=>{var n,s;let o=!t||a.title.toLowerCase().includes(t.toLowerCase()),r=!(null==e?void 0:e.author)||(null==(n=a.author)?void 0:n.toLowerCase().includes(e.author.toLowerCase())),i=!(null==e?void 0:e.language)||(null==(s=a.language)?void 0:s.toLowerCase().includes(e.language.toLowerCase())),l=((null==e?void 0:e.tags)||[]).filter(e=>e),d=0===l.length||l.every(e=>{var t;return null==(t=a.tags)?void 0:t.includes(e)}),c=new Date(a.date||""),u=!(null==e?void 0:e.dateFrom)||c>=new Date(e.dateFrom),h=!(null==e?void 0:e.dateTo)||c<=new Date(e.dateTo);return o&&r&&i&&d&&u&&h})}async function o(e){let t=await fetch("/api/documents/".concat(e));return t.ok?t.json():null}async function r(e){let t=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e})});return t.ok?(await t.json()).reply||"Brak odpowiedzi.":(console.error("❌ Błąd czatu:",await t.text()),"Nie udało się uzyskać odpowiedzi.")}async function i(e){let t=await fetch("/api/documents/".concat(e));return t.ok?t.json():null}async function l(e){let t=await fetch("/api/documents/".concat(e),{method:"DELETE"});if(!t.ok){let e=await t.text().catch(()=>t.statusText);throw console.error("❌ deleteDocument error:",t.status,e),Error("Usuwanie dokumentu nie powiodło się")}}async function d(e,t){let a=new FormData;a.append("file",e),a.append("title",t.title||e.name),a.append("author",t.author||""),a.append("date",t.date||new Date().toISOString()),a.append("language",t.language||""),a.append("tags",JSON.stringify(t.tags||[])),a.append("keywords",JSON.stringify(t.keywords||[])),a.append("content",t.content||"");let n=await fetch("/api/documents",{method:"POST",body:a}),s=await n.text();if(console.log("uploadDocument status",n.status,"body",s),!n.ok)throw Error(s||n.statusText);return JSON.parse(s)}},1999:(e,t,a)=>{Promise.resolve().then(a.bind(a,5986))},5695:(e,t,a)=>{"use strict";var n=a(8999);a.o(n,"useParams")&&a.d(t,{useParams:function(){return n.useParams}}),a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}})},5986:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var n=a(5155),s=a(2115),o=a(6874),r=a.n(o),i=a(5695),l=a(1886);function d(e){let{variant:t="default",className:a,children:s}=e;return(0,n.jsx)("span",{className:"".concat("inline-block px-2 py-1 text-sm font-medium rounded-full"," ").concat("secondary"===t?"bg-gray-200 text-gray-800":"bg-blue-100 text-blue-800"," ").concat(a||"").trim(),children:s})}function c(){var e,t;let{id:a}=(0,i.useParams)(),o=(0,i.useRouter)(),[c,u]=(0,s.useState)(null),[h,p]=(0,s.useState)(!0),[m,x]=(0,s.useState)(!1);(0,s.useEffect)(()=>{a&&(async()=>{p(!0),u(await (0,l.sW)(a)),p(!1)})()},[a]);let g=async()=>{if(confirm("Na pewno usunąć ten dokument?")){x(!0);try{await (0,l.Nn)(a),o.push("/explore")}catch(e){console.error(e),alert("Nie udało się usunąć dokumentu."),x(!1)}}};return h?(0,n.jsx)("p",{className:"text-center mt-10 text-gray-500",children:"Ładowanie dokumentu…"}):c?(0,n.jsx)("div",{className:"h-screen overflow-hidden",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 h-full items-start",children:[(0,n.jsx)("div",{className:"lg:col-span-1 self-start",children:(0,n.jsxs)("div",{className:"bg-white px-6 py-4 space-y-2 rounded shadow",children:[(0,n.jsxs)("header",{className:"space-y-2",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:c.title}),(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:[c.author&&(0,n.jsxs)("div",{children:["Autor: ",c.author]}),c.language&&(0,n.jsxs)("div",{children:["Język: ",c.language]}),c.date&&(0,n.jsxs)("div",{children:["Data: ",new Date(c.date).toLocaleDateString()]})]}),(0,n.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,n.jsx)(r(),{href:"/edit/".concat(a),className:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600",children:"Edytuj"}),(0,n.jsx)("button",{onClick:g,disabled:m,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50",children:m?"Usuwanie…":"Usuń"})]})]}),(0,n.jsxs)("section",{children:[(0,n.jsx)("h2",{className:"font-semibold text-lg mb-1",children:"Podsumowanie"}),(0,n.jsx)("p",{className:"text-gray-800 whitespace-pre-line text-sm",children:c.summary||c.content||"Brak treści dokumentu."})]}),(null==(e=c.keywords)?void 0:e.length)>0&&(0,n.jsxs)("section",{children:[(0,n.jsx)("h2",{className:"font-semibold text-lg mb-1",children:"Słowa kluczowe"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:c.keywords.map(e=>(0,n.jsx)(d,{variant:"secondary",children:e},e))})]}),(null==(t=c.tags)?void 0:t.length)>0&&(0,n.jsxs)("section",{children:[(0,n.jsx)("h2",{className:"font-semibold text-lg mb-1",children:"Tagi użytkownika"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:c.tags.map(e=>(0,n.jsx)(d,{children:e},e))})]})]})}),(0,n.jsx)("div",{className:"lg:col-span-2 h-full",children:c.fileUrl?(0,n.jsx)("object",{data:"".concat(c.fileUrl,"#page=1&view=FitH"),type:"application/pdf",width:"100%",height:"100%",className:"w-full h-full",children:(0,n.jsx)("p",{children:"Podgląd PDF niedostępny"})}):(0,n.jsx)("div",{className:"text-gray-500 p-4",children:"Brak pliku PDF"})})]})}):(0,n.jsx)("p",{className:"text-center mt-10 text-red-500",children:"Nie znaleziono dokumentu."})}}},e=>{var t=t=>e(e.s=t);e.O(0,[874,441,684,358],()=>t(1999)),_N_E=e.O()}]);